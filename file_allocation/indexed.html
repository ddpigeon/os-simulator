<!DOCTYPE html>
<html lang="en" class="no-js">

<head>
    <title>Indexed Allocation</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OS Simulator</title>
    <style>
        body {
            background-color: black;
            padding: 0px;
        }

        .container {
            background-color: rgb(0, 255, 255);
            height: 100vh;
        }

        input, button {
            color: black;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            color: black;
        }

        th, td {
            text-align: left;
            padding: 8px;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="Text" style="color: black; margin-left: 22px">
            <h1 class="some" behavior="alternate" scrollamount=10 style="font-weight: bold">INDEXED ALLOCATION</h1>
            <div id="sequ">
                <div class="visible1">
                    <p> Enter the size of memory(number of blocks)</p>
                    <input id="nof" type="number">
                    <button class="s_done" onclick="getSize()">Submit</button>

                    <br><br>

                    <div class="s_form s_hide" id="vis2">
                        <p> Please add file details </p>
						<div>File name: <input id="file_name" type="text"></div>
                        <br>
						<div>File size(number of blocks): <input id="file_size" type="number"></div>
                        <br>
						<div>Block numbers (comma-separated): <input id="block_numbers" type="text"></div>
						<br>
                        
                        <button class="s_done" onclick="addFile()">Add</button>
                        <br>
                    </div>
                    <table>
                        <tr>
                            <th>File</th>
                            <th>Start</th>
                            <th>End</th>
                            <th>Size</th>
                            <th>Blocks</th>
                        </tr>
                        <tbody id="output"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</body>

<script>
    var used, next, remaining, allocations;
    var file_sizes = new Array(200);
    var file_names = new Array(200);
    var block_numbers_arr = new Array(200);
    var count = 0;
    var memSize;

    function getSize() {
        memSize = document.getElementById("nof").value;

        if (memSize != "") {
            vis2 = document.getElementById("vis2");
            vis2.style.visibility = "visible";
            vis2.classList.remove("s_hide");

            used = new Array(parseInt(memSize));
            next = new Array(parseInt(memSize));
            remaining = parseInt(memSize);
            allocations = new Array(parseInt(memSize));
            for (var i = 0; i < parseInt(memSize); i++) {
                allocations[i] = -1;
                used[i] = false;
                next[i] = -1;
            }
        }
        else
            alert("Please enter valid size!");
    }

    function addFile() {
        var name = document.getElementById("file_name").value;
        var size = document.getElementById("file_size").value;
        var blockNumbers = document.getElementById("block_numbers").value;
        size = parseInt(size);

        if (name != "" && size != "" && blockNumbers != "") {
            if (size > remaining) {
                alert("Cannot allocate!!");
            }
            else {
                block_numbers_arr[count] = blockNumbers.split(',').map(Number).filter(function(n) { return !isNaN(n); });
                if (block_numbers_arr[count].length !== size) {
                    alert("Invalid block numbers. Please enter " + size + " block numbers separated by commas.");
                    return;
                }
                for (var i = 0; i < block_numbers_arr[count].length; i++) {
                    var blockNum = block_numbers_arr[count][i];
                    if (blockNum >= memSize || blockNum < 0 || used[blockNum]) {
                        alert("Invalid block number: " + blockNum);
                        return;
                    }
                    allocations[blockNum] = count + 1;
                    used[blockNum] = true;
                }
                file_names[count] = name;
                file_sizes[count] = size;
                count++;
                showOutput();
                remaining -= size;
            }
        }
        else {
            alert("Please enter all details!!");
        }
    }

    function showOutput() {
        var output = document.getElementById("output");
        output.innerHTML = "";

        for (var i = 0; i < count; i++) {
            var start = block_numbers_arr[i][0];
            var end = block_numbers_arr[i][block_numbers_arr[i].length - 1];
            var row = document.createElement("tr");

            var fileCell = document.createElement("td");
            fileCell.innerHTML = file_names[i];
            row.appendChild(fileCell);

            var startCell = document.createElement("td");
            startCell.innerHTML = start;
            row.appendChild(startCell);

            var endCell = document.createElement("td");
            endCell.innerHTML = end;
            row.appendChild(endCell);

            var sizeCell = document.createElement("td");
            sizeCell.innerHTML = file_sizes[i];
            row.appendChild(sizeCell);

            var blocksCell = document.createElement("td");
            blocksCell.innerHTML = block_numbers_arr[i].join(',');
            row.appendChild(blocksCell);

            output.appendChild(row);
        }
    }
</script>

</html>